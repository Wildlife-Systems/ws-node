#!/bin/bash
# filepath: c:\Users\edwab\OneDrive - Natural History Museum\Documents\GitHub\ws-node\DEBIAN\postrm

set -e

case "$1" in
    remove|purge)
        echo "Cleaning up WildlifeSystems services..."
        
        # Remove service files if they still exist
        for file in /etc/systemd/system/ws-*.service /etc/systemd/system/ws-*.timer; do
            if [ -f "$file" ]; then
                echo "Removing $file"
                rm -f "$file" || true
            fi
        done
        
        # Reload systemd
        systemctl daemon-reload || true
        
        if [ "$1" = "purge" ]; then
            echo "Purging WildlifeSystems configuration and logs..."
            # Remove configuration files
            rm -rf /etc/ws/ || true
            # Remove log files
            rm -f /var/log/ws-*.log || true
        fi
        ;;
        
    upgrade|failed-upgrade|abort-install|abort-upgrade|disappear)
        # Don't clean up on upgrade
        ;;
        
    *)
        echo "postrm called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac

exit 0