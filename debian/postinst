#!/bin/bash

###DEBHELPER###

set -e

chmod +x /usr/bin/ws-indicate
chmod +x /usr/bin/ws-heartbeat
chmod +x /usr/bin/ws-run-audio
chmod +x /usr/bin/ws-run-sensors
chmod +x /usr/bin/ws-network


case "$1" in
    configure)
        echo "Configuring WildlifeSystems services..."
        
        # Clean up old service file locations from previous versions
        for old_file in /etc/systemd/system/ws-*.service /etc/systemd/system/ws-*.timer; do
            if [ -f "$old_file" ]; then
                echo "Removing old service file: $old_file"
                rm -f "$old_file" || true
            fi
        done
        
        # Reload systemd to pick up new service files
        systemctl daemon-reload
        
        echo "WildlifeSystems services configured successfully"
        ;;
        
    abort-upgrade|abort-remove|abort-deconfigure)
        # Handle rollback scenarios
        echo "Handling package configuration abort for case: $1"
        ;;
        
    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac

exit 0
